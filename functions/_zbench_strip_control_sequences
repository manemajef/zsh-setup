if (( $+commands[perl] )); then
  perl -0pe '
    s/\e\[[0-9;?]*[ -\/]*[@-~]//g;     # CSI sequences
    s/\e\][^\a]*(?:\a|\e\\)//g;        # OSC sequences
    s/\eP.*?\e\\//gs;                  # DCS sequences
    s/\e[\(\)][0-9A-Za-z]//g;          # Character set selections
    s/\r//g;                           # Carriage returns
  '
else
  cat
fi
