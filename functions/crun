# Usage: crun file.c
# Example: crun src/main.c   â†’ compiles to ./out/main and runs it

local src="$1"
if [[ -z "$src" ]]; then
  echo "Usage: crun <source.c>"
  return 1
fi

if ! [[ -f "$src" ]]; then
  echo "Error: '$src' not found"
  return 1
fi

# Extract filename without extension
local name="${src##*/}"          # remove path â†’ main.c
name="${name%.*}"                # remove .c â†’ main

# Define output path
local out_dir="./out"
local out_path="$out_dir/$name"

# Ensure ./out exists
mkdir -p "$out_dir"

echo "ğŸ”§ Compiling $src â†’ $out_path"
gcc "$src" -o "$out_path" || { echo "âŒ Compilation failed"; return 1; }

echo "â–¶ï¸  Running $out_path"
"$out_path"
